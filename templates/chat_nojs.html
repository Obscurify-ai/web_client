<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Chat privately with frontier AI models. Your VPN for AI - no logs, no tracking. Works without JavaScript.">
    <title>Chat - Obscurify.ai</title>
    <link rel="icon" href="/static/images/favicon.ico" sizes="any">
    <link rel="stylesheet" href="/static/styles/common.css">
    <link rel="stylesheet" href="/static/styles/chat.css">
    <link rel="stylesheet" href="/static/styles/chat_nojs.css">
</head>
<body>
    <nav class="navbar">
        <a class="navbar-brand" href="/">Obscurify.ai</a>

        <input type="checkbox" id="nav-toggle" hidden>
        <label for="nav-toggle" class="navbar-toggler">
            <span class="navbar-toggler-icon"></span>
        </label>

        <ul class="navbar-nav" id="navbarNavDropdown">
            <li class="nav-item">
                <a class="nav-link" href="/model_cards">Models</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/signup">Sign Up</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/account">Account</a>
            </li>
            <li class="nav-item nav-chat-btn">
                <a class="btn btn-chat" href="/chat">Chat</a>
            </li>
        </ul>
    </nav>

    <div id="main-content">
        {% if chat_messages.is_empty() %}
        <div id="welcome-message">
            <div class="welcome-content">
                <h2>Anonymous AI Chat</h2>
                <p class="nojs-note">Tor and JavaScript-free version available <a href="http://obscure2sm2fs5uqtpuqv4qsalqi6hxtje3xgxmtaeoy4bjlqau6c4id.onion/chat_nojs">here</a>.</p>
            </div>
        </div>
        {% else %}
        <div id="response-list" style="display: block;">
            {% for message in chat_messages %}
            <div class="message {% if message.role == "user" %}user-message{% else %}assistant-message{% endif %}">
                <strong>{{ message.role|capitalize }}:</strong>
                <div class="prompt-content markdown-content">{{ message.content_html|safe }}</div>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <div id="bottom-container">
        <form method="POST" action="/chat_nojs" enctype="multipart/form-data" autocomplete="on">
            <input type="hidden" name="message_history" value="{{ message_history }}">

            <div id="model-select-container">
                <div class="model-selector">
                    <label for="model-select">Model:</label>
                    <select id="model-select" name="model">
                        {% for model in available_models %}
                        <option value="{{ model.id }}" {% if model.id == selected_model %}selected{% endif %}>
                            {{ model.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="token-group">
                    <button type="submit" name="action" value="clear" class="clear-chat-btn">Clear</button>
                </div>
            </div>

            <div id="input-container">
                <textarea name="prompt"
                          placeholder="Type your message..."
                          required>{{ previous_prompt }}</textarea>

                <label class="image-upload-label" title="Attach image">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21 15 16 10 5 21"></polyline>
                    </svg>
                    <input type="file"
                           name="images"
                           accept="image/*"
                           multiple>
                </label>

                <button type="submit" name="action" value="chat" class="submit-btn-nojs" title="Send message">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                    </svg>
                </button>
            </div>
        </form>
    </div>
</body>
</html>
